<?xml version="1.0" encoding="utf-8"?>
<Patch>

    <!-- ========== Add groups entry if it doesn't exist already ========== -->

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="SightSensor"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="SightSensor"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="HearingSensor"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="HearingSensor"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="SmellSensor"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="SmellSensor"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallMechanicalHand"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallMechanicalHand"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallFloatingUnit"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallFloatingUnit"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallFloatingUnit"]/parts/li[def="SmallAntiGravityCore"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallFloatingUnit"]/parts/li[def="SmallAntiGravityCore"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ColossusBody" or defName="PMP_ImmortalBody"]/corePart/parts/li[def="GiantMechanicalJoint"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ColossusBody" or defName="PMP_ImmortalBody"]/corePart/parts/li[def="GiantMechanicalJoint"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_ColossusBody" or defName="PMP_ImmortalBody"]/corePart/parts/li[def="GiantMechanicalJoint"]/parts/li[def="GiantMechanicalLeg"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_ColossusBody" or defName="PMP_ImmortalBody"]/corePart/parts/li[def="GiantMechanicalJoint"]/parts/li[def="GiantMechanicalLeg"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalLeg"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalLeg"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalLeg"]/parts/li[def="MechanicalFoot"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalLeg"]/parts/li[def="MechanicalFoot"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <!-- shoulder -->
    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/parts/li[def="MechanicalHand"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/parts/li[def="MechanicalHand"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <Operation Class="PatchOperationConditional">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/parts/li[def="MechanicalHand"]/parts/li[def="MechanicalFinger"]/groups</xpath>
        <nomatch Class="PatchOperationAdd">
            <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/parts/li[def="MechanicalHand"]/parts/li[def="MechanicalFinger"]</xpath>
            <value>
                <groups />
            </value>
        </nomatch>
    </Operation>

    <!-- ========== Add armor coverage ========== -->

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="SightSensor"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="HearingSensor"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody" or defName="PMP_ColossusBody" or defName="PMP_ImmortalBody" or defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalNeck"]/parts/li[def="MechanicalHead"]/parts/li[def="SmellSensor"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallMechanicalHand"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallFloatingUnit"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ProbeBody"]/corePart/parts/li[def="SmallFloatingUnit"]/parts/li[def="SmallAntiGravityCore"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ColossusBody" or defName="PMP_ImmortalBody"]/corePart/parts/li[def="GiantMechanicalJoint"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_ColossusBody" or defName="PMP_ImmortalBody"]/corePart/parts/li[def="GiantMechanicalJoint"]/parts/li[def="GiantMechanicalLeg"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalLeg"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalLeg"]/parts/li[def="MechanicalFoot"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/parts/li[def="MechanicalHand"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>

    <Operation Class="PatchOperationAdd">
        <xpath>Defs/BodyDef[defName="PMP_HumanoidBody"]/corePart/parts/li[def="MechanicalShoulder"]/parts/li[def="MechanicalArm"]/parts/li[def="MechanicalHand"]/parts/li[def="MechanicalFinger"]/groups</xpath>
        <value>
            <li>CoveredByNaturalArmor</li>
        </value>
    </Operation>
</Patch>